Vite组成：

1.No-Bundle开发服务器

源文件无需打包，直接以原生ES modules的形式加载

2.生产构建

基于Rollup预先配置好的，针对生产环境高度优化的打包命令。



Vite的设计基于两个新趋势

1.现代JavaScript支持广泛铺开

2.新一代的用原生编译语言写的JS编译器（基于Go的esbuild）



原生ESM开发服务器的优势

1.不需要打包源码

2.自然按需处理

3.可直接利用浏览器缓存

4.可以实现更简单高效的热更新（HMR）



原生ESM服务器的技术挑战

HTTP请求开销

加载大量的小模块=大量的并发HTTP请=慢



如何减少HTTP请求开销？

1.用esbuild进行依赖预打包

保证一个依赖对应最多一个HTTP请求

同时处理CommonJs转ESM的兼容

2.利用HTTP header缓存依赖

对预打包过后的一阿里的请求会带有`？v=xxxxxxx`指纹

直接上强缓存`Cache-Control: max-age=31536000,immutable`

除非依赖版本变化，否则不会再产生HTTP请求

3.优化源文件请求

源文件返回的header中带有etag

服务器会保存每个文件的更新状态，没有改动的文件直接返回`304 Not Modified`



为什么生产还是要打包？

简单说：不打包的部署模式会导致大量的级联HTTP请求，对缓存策略也有复杂的要求，目前来说依然不如打包的的部署策略。



MBC业务标准化容器在美团的实践

1.标准化

数据标准化

埋点标准化

交互标准化

设计语言标准化

2.动态化

动态孵化页面

客户端容器动态化

服务端容器动态化

3.配置化

页面配置化

模版配置化

埋点配置化

4.智能化

千人千面

